name: CI

on: pull_request

jobs:
  ci_run:

    runs-on: ubuntu-latest

    steps:

      # actions/checkout@v2 gives access to the repo (https://github.com/actions/checkout)
      - uses: actions/checkout@v2

      # Build the docker container with our custom Dockerfile
      - name: Build Docker container
        run: docker build --file tools/Dockerfile --tag ci_run .

      # Run the CI checks in the docker container
      # Note: The GITHUB_WORKSPACE volume (repo location) is mounted to /workdir in the container.
      - name: Run Docker container
        run: docker run ci_run --volume ${GITHUB_WORKSPACE}:/workdir ci_run.sh
